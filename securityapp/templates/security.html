{% extends "base.html" %}
{% block content %}
<h2>Security Section</h2>
{% if message %}
  <p>{{ message }}</p>
{% endif %}

<form method="post" style="margin-bottom: 20px;">
  {% csrf_token %}
  <input type="hidden" name="action" value="start">
  <button type="submit" class="btn">Start Security System</button>
</form>

<hr>

<h3>Upload Face Image</h3>
<form method="post" enctype="multipart/form-data" style="margin-bottom: 20px;">
  {% csrf_token %}
  <input type="hidden" name="action" value="upload">
  <div>
    <label for="face_image">Selected Image:</label>
    <span id="file-name">No file selected</span>
    <!-- Hidden file input -->
    <input type="file" id="face_image" name="face_image" accept="image/*" style="display: none;" required
           onchange="document.getElementById('file-name').innerText = this.files[0].name;">
    <!-- Button that triggers the file input -->
    <button type="button" onclick="document.getElementById('face_image').click();">Select Image</button>
  </div>
  <div>
    <label for="individual_type">Individual Type:</label>
    <select id="individual_type" name="individual_type" required>
      <option value="protected">Protected</option>
      <option value="warning">Warning</option>
    </select>
  </div>
  <div style="margin-top: 10px;">
    <button type="submit" class="btn">Upload Face</button>
  </div>
</form>

<hr>

<div id="video-feed" style="margin-top:20px;">
  <h3>Live Video Feed</h3>
  <img id="video-feed-img" src="{% url 'video_feed' %}" alt="Video Feed" style="width:100%;">
</div>

<script>
document.addEventListener('keyup', function(e) {
    if (e.key === "Escape") {
        var videoFeed = document.getElementById('video-feed');
        if (videoFeed) {
            videoFeed.style.display = 'none';
        }
    }
});
</script>
{% endblock %}
